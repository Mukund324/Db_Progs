SALESMAN (Salesman_id, Name, City, Commission)
CUSTOMER (Customer_id, Cust_Name, City,
Grade,Salesman_id)
ORDERS (Ord_No, Purchase_Amt, Ord_Date, Customer_id,Salesman_id)

CREATE TABLE SALESMAN
(SALESMAN_ID NUMBER (4),
NAME VARCHAR2 (20),
CITY VARCHAR2 (20),
COMMISSION VARCHAR2 (20),
PRIMARYKEY (SALESMAN_ID));
CREATE TABLE CUSTOMER1
(CUSTOMER_ID NUMBER (4),
CUST_NAME VARCHAR2 (20),
CITY VARCHAR2 (20),
GRADE NUMBER (3),
PRIMARY KEY (CUSTOMER_ID),
SALESMAN_ID REFERENCES SALESMAN (SALESMAN_ID) ON DELETE SET NULL);
CREATE TABLE ORDERS
(ORD_NO NUMBER (5),
PURCHASE_AMT NUMBER (10, 2),
ORD_DATE DATE,
PRIMARY KEY (ORD_NO),
CUSTOMER_ID REFERENCES CUSTOMER1 (CUSTOMER_ID) ON DELETE CASCADE,
SALESMAN_ID REFERENCES SALESMAN (SALESMAN_ID) ON DELETE CASCADE);
INSERTINTOORDERSVALUES(52,1000,E24-FEB-17‘,13,2000);
INSERTINTOORDERSVALUES(53,3500,E13-APR-17‘,14,3000);
INSERT INTO ORDERS VALUES (54, 550, E09-MAR-17‘, 12, 2000);

Queries

Count the customers with grades above
Bangalore’saverage. SELECT GRADE, COUNT (DISTINCT
CUSTOMER_ID) FROMCUSTOMER1
GROUP BY GRADE
HAVING GRADE > (SELECT AVG(GRADE)
FROM CUSTOMER1
WHERE CITY='BANGALORE');

Find the name and numbers of all salesmen who had more than onecustomer.
SELECT SALESMAN_ID, NAME FROM
SALESMAN A
WHERE 1 < (SELECT COUNT (*)
FROM CUSTOMER1
WHERE SALESMAN_ID=A.SALESMAN_ID);



List all salesmen and indicate those who have and don’t have customers in
their cities (Use UNIONoperation.)
SELECT SALESMAN.SALESMAN_ID, NAME, CUST_NAME, COMMISSION FROM
SALESMAN, CUSTOMER1
WHERE SALESMAN.CITY = CUSTOMER1.CITY
UNION
SELECT SALESMAN_ID, NAME, 'NO MATCH', COMMISSION FROM
SALESMAN
WHERE NOT CITY = ANY
(SELECT CITY
FROM CUSTOMER1)
ORDER BY 2 DESC;


Create a view that finds the salesman who has the customer with the
highest order of aday.
CREATE VIEW ELITSALESMAN AS
SELECT B.ORD_DATE, A.SALESMAN_ID, A.NAME FROM
SALESMAN A, ORDERS B
DBMS Lab Manual 17CSL58
Page 17
WHERE A.SALESMAN_ID = B.SALESMAN_ID
AND B.PURCHASE_AMT=(SELECT MAX (PURCHASE_AMT)
FROM ORDERS C WHERE C.ORD_DATE = B.ORD_DATE);

Demonstrate the DELETE operation by removing salesman with id 1000. All his
orders must also bedeleted.
DELETE FROM SALESMAN
WHERE SALESMAN_ID=1000;
WHERE C.ORD_DATE = B.ORD_DATE);
ORDER BY 2 DESC;
WHERE SALESMAN_ID=A.SALESMAN_ID);
WHERE CITY='BANGALORE');